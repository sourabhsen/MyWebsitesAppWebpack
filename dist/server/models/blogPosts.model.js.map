{"version":3,"sources":["../../../app/models/blogPosts.model.js"],"names":["fs","require","app","Schema","blogpostschema","title","String","description","type","required","link","created_at","Date","updated_at","date_label","img","data","Buffer","contentType","pageUrl","upvotes","Number","default","downvotes","comments","name","firstL","comment","plugin","pre","next","currentDate","_id","replace","toDateString","Blog","model","module","exports"],"mappings":";;AAAA;;;;AACA;;;;AAEA;;;;;;AAEA,IAAIA,KAAKC,QAAQ,IAAR,CAAT;;AAEA,IAAIC,MAAM,wBAAV;;AAEA,IAAKC,SAAS,mBAASA,MAAvB;;AAEA,IAAKC,iBAAiB,IAAID,MAAJ,CAAW;AAC7BE,WAAMC,MADuB;AAE7BC,iBAAY,EAACC,MAAMF,MAAP,EAAeG,UAAS,IAAxB,EAFiB;AAG7BC,UAAKJ,MAHwB;AAI7BK,gBAAYC,IAJiB;AAK7BC,gBAAYD,IALiB;AAM7BE,gBAAWR,MANkB;AAO7BS,SAAK,EAAEC,MAAMC,MAAR,EAAgBC,aAAYZ,MAA5B,EAPwB;AAQ7Ba,aAAQb,MARqB;AAS7Bc,aAAQ,EAACZ,MAAMa,MAAP,EAAeC,SAAS,CAAxB,EATqB;AAU7BC,eAAU,EAACf,MAAMa,MAAP,EAAeC,SAAS,CAAxB,EAVmB;AAW7BE,cACI,CACI;AACIC,cAAKnB,MADT;AAEIoB,gBAAOpB,MAFX;AAGIqB,iBAAQrB;AAHZ,KADJ;AAZyB,CAAX,CAAtB;;AAsBAF,eAAewB,MAAf;;AAEA;AACAxB,eAAeyB,GAAf,CAAmB,MAAnB,EAA2B,UAASC,IAAT,EAAe;AACxC;AACA,QAAIC,cAAc,IAAInB,IAAJ,EAAlB;;AAEA;AACA,SAAKC,UAAL,GAAkBkB,WAAlB;;AAGA;AACA,QAAG,KAAKC,GAAL,IAAY,KAAK3B,KAApB,EAA0B;AACtB,YAAIA,QAAQ,KAAKA,KAAL,CAAW4B,OAAX,CAAmB,KAAnB,EAAyB,GAAzB,CAAZ;AACA,aAAKd,OAAL,GAAe,WAAW,KAAKa,GAAhB,GAAqB,GAArB,GAA0B3B,KAAzC;AACH;;AAED;AACA,QAAI,CAAC,KAAKM,UAAV,EAAqB;AACnB,aAAKA,UAAL,GAAkBoB,WAAlB;AACA,aAAKjB,UAAL,GAAmB,KAAKH,UAAL,CAAgBuB,YAAhB,EAAnB;AACD,KAHD,MAGK;AACD,aAAKpB,UAAL,GAAmB,KAAKH,UAAL,CAAgBuB,YAAhB,EAAnB;AACH;;AAEDJ;AACD,CAvBD;;AA0BC,IAAIK,OAAQ,mBAASC,KAAT,CAAe,UAAf,EAA0BhC,cAA1B,CAAZ;;AAEA;;AAEDiC,OAAOC,OAAP,GAAkBH,IAAlB","file":"blogPosts.model.js","sourcesContent":["import mongoose from 'mongoose';\r\nimport express from 'express';\r\n\r\nimport mongoosePaginate from 'mongoose-paginate';\r\n\r\nlet fs = require('fs');\r\n\r\nlet app = express();\r\n\r\nlet  Schema = mongoose.Schema;\r\n\r\nlet  blogpostschema = new Schema({\r\n    title:String,\r\n    description:{type: String, required:true},\r\n    link:String,\r\n    created_at: Date,\r\n    updated_at: Date,\r\n    date_label:String,\r\n    img: { data: Buffer ,contentType:String },\r\n    pageUrl:String,\r\n    upvotes:{type: Number, default: 0},\r\n    downvotes:{type: Number, default: 0},\r\n    comments:\r\n        [\r\n            {\r\n                name:String,\r\n                firstL:String,\r\n                comment:String\r\n            }\r\n        ]\r\n});\r\n\r\n\r\nblogpostschema.plugin(mongoosePaginate);\r\n\r\n// on every save, add the date\r\nblogpostschema.pre('save', function(next) {\r\n  // get the current date\r\n  var currentDate = new Date();\r\n  \r\n  // change the updated_at field to current date\r\n  this.updated_at = currentDate;\r\n\r\n  \r\n  //pageUrllink\r\n  if(this._id && this.title){\r\n      let title = this.title.replace(/\\W/g,'-');\r\n      this.pageUrl = '/post/' + this._id +'/'+ title;\r\n  }\r\n\r\n  // if created_at doesn't exist, add to that field\r\n  if (!this.created_at){\r\n    this.created_at = currentDate;\r\n    this.date_label =  this.created_at.toDateString();\r\n  }else{\r\n      this.date_label =  this.created_at.toDateString();\r\n  }\r\n\r\n  next();\r\n});\r\n\r\n \r\n var Blog =  mongoose.model('blogpost',blogpostschema)\r\n\r\n //export default mongoose.model('BlogPost', BlogPostschema,'BlogPost');\r\n\r\nmodule.exports  = Blog;"]}